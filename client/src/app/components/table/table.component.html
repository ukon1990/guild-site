<div class="table-container mat-elevation-z8">
  <table *ngIf="!isLoading; else isLoadingTemplate"
    mat-table
    matSort
    [dataSource]="dataSource"
    (matSortChange)="sortRows($event)"
  >
    <ng-container
      *ngFor="let column of columns; let id = index"
      [matColumnDef]="'' + id"
      [sticky]="column.sticky"
      [stickyEnd]="column.stickyEnd"
    >
      <th mat-header-cell *matHeaderCellDef mat-sort-header>
        {{ column.title }}
      </th>
      <td
        mat-cell
        *matCellDef="let row; let rowIndex = index"
        (click)="handleColumnClick(column, row, id)"
      >
        <app-column
          [column]="column"
          [index]="rowIndex + (paginator?.pageSize || 0) * (paginator?.pageIndex || 0)"
          [row]="row"
        ></app-column>
      </td>
      <ng-container *ngIf="footerRowData">
        <td mat-footer-cell *matFooterCellDef="let row">
          <app-column [column]="column" [row]="footerRowData"></app-column>
        </td>
      </ng-container>
    </ng-container>

    <tr mat-header-row *matHeaderRowDef="columnKeys; sticky: true"></tr>
    <tr mat-row *matRowDef="let row; columns: columnKeys"></tr>
    <ng-container *ngIf="footerRowData">
      <tr mat-footer-row *matFooterRowDef="columnKeys; sticky: true"></tr>
    </ng-container>
  </table>

  <ng-template #isLoadingTemplate>
    <mat-spinner></mat-spinner>
    Loadingâ€¦
  </ng-template>

  <mat-paginator
    [style]="{display: dataSource.data.length > (paginator?.pageSize || 0) ? 'inherit' : 'none'}"
    [pageSizeOptions]="[5, 10, 20]"
    showFirstLastButtons
  ></mat-paginator>
</div>
